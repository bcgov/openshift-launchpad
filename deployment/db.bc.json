{
    "kind": "Template",
    "apiVersion": "v1",
    "labels": {
      "template": "openshift-launchpad",
      "service": "db"
    },
    "parameters": [
      {
        "name": "NAMESPACE",
        "required": true
      }
    ],
    "metadata": {
      "name": "db-build-config"
    },
    "objects": [
      {
        "apiVersion": "v1",
        "kind": "ImageStream",
        "metadata": {
            "annotations": {
                "openshift.io/display-name": "PostgreSQL"
            },
            "name": "postgresql",
            "namespace": "${NAMESPACE}"
        },
        "spec": {
            "tags": [
              {
                "from": {
                    "kind": "DockerImage",
                    "name": "docker.io/centos/postgresql-10-centos7:latest"
                },
                "name": "10",
                "referencePolicy": {
                    "type": "Local"
                }
              }
            ]
        }
    },
      {
        "kind": "BuildConfig",
        "apiVersion": "v1",
        "metadata": {
          "name": "postgresql-bc"
        },
        "spec": {
          "completionDeadlineSeconds": 600,
          "triggers": [
            {
              "type": "ImageChange"
            },
            {
              "type": "ConfigChange"
            }
          ],
          "runPolicy": "SerialLatestOnly",
          "source": {
            "type": "Git",
            "git": {
              "uri": "https://github.com/bcgov/openshift-launchpad",
              "ref": "origin/deployment"
            },
            "contextDir": "database"
          },
          "strategy": {
            "dockerStrategy": {
              "from": {
                "kind": "ImageStreamTag",
                "name": "postgresql:10",
                "namespace": "${NAMESPACE}"
              }
            },
            "type": "Docker"
          },
          "output": {
            "to": {
              "kind": "ImageStreamTag",
              "name": "postgresql:latest",
              "namespace": "${NAMESPACE}"
            }
          },
          "resources": {
            "limits": {
              "cpu": "500m",
              "memory": "3Gi"
            },
            "requests": {
              "cpu": "100m",
              "memory": "2Gi"
            }
          }
        }
      }
    ]
  }
